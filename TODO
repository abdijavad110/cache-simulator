FIXME: use locks for Qs
